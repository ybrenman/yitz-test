<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Pivotal Product Documentation : JavaScript Data Ingest SDK</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="page">
            <div id="main">
                <div id="main-header" class="pageSectionHeader">
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Pivotal Product Documentation : JavaScript Data Ingest SDK
                        </span>
                    </h1>

                    <div class="page-metadata">
                        <p>This page last changed on Oct 23, 2013 by <font color="#0050B2">rawlie</font>.</p>
                    </div>
                </div>

                <div id="content" class="view">
                    <div id="main-content" class="wiki-content group">
                    <p><strong>Note</strong>: this page was copied from : </p><p><a href="https://cetasbigdata.atlassian.net/wiki/pages/viewpage.action?pageId=3670018" class="external-link" rel="nofollow">https://cetasbigdata.atlassian.net/wiki/pages/viewpage.action?pageId=3670018</a></p><p>There are also some examples: </p><div class="pageSectionBody children-loaded"><span class="child-display"> <span class="icon icon-page" title="Page">Page:</span> <a href="https://cetasbigdata.atlassian.net/wiki/pages/viewpage.action?pageId=4063236" class="external-link" rel="nofollow">eCommerce Tracking Sample (JavaScript)</a> </span> <span class="child-display"> <span class="icon icon-page" title="Page">Page:</span> <a href="https://cetasbigdata.atlassian.net/wiki/pages/viewpage.action?pageId=4063238" class="external-link" rel="nofollow">Gaming Tracking Sample (JavaScript)</a> </span> <span class="child-display"> <span class="icon icon-page" title="Page">Page:</span> <a href="https://cetasbigdata.atlassian.net/wiki/pages/viewpage.action?pageId=4063257" class="external-link" rel="nofollow">Setting the &quot;paid&quot; flag for visitors (JavaScript)</a> </span></div><p>content has not been reviewed for current accuracy. </p><h3 id="JavaScriptDataIngestSDK-Overview">Overview</h3><p>This page discusses how to use Cetas' JavaScript SDK for instrumenting web applications with the objective to track customer web data, such as the number of visitors, sessions, transactions and page click statistics. Developers or site administrators need to install the minimal code snippets described below on the various pages of their web sites and choose the appropriate APIs from the list of options below.</p><h3 id="JavaScriptDataIngestSDK-GettingtheApplicationKey">Getting the Application Key</h3><p>When developers create an application in Cetas, the application key will be shown after the application is created/registered successfully. The application key is required to be sent with every request so that Cetas can decipher the data and assign it to the proper application. The Cetas Web interface provides ready-made JavaScript code snippets that include the application key of the corresponding application. </p><h3 id="JavaScriptDataIngestSDK-AddingtheCetastrackingcode">Adding the Cetas tracking code </h3><p>Site Owners/Administrators (or Developers) need to copy/paste the sample code snippet below into their web pages. This serves as the minimal code that needs to be added to perform any type of tracking.</p><p> </p>    <div class="aui-message hint shadowed information-macro">
                            <span class="aui-icon icon-hint"></span>
                <div class="message-content">
                            <p>Please remember to replace the application key in the code below with the one you got from the first step (Note that the Cetas Web interface provides ready-made JavaScript code snippets that include the application key of the corresponding application.)</p>
                    </div>
    </div>
<p> </p><div class="message-content"><p> </p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: javascript; gutter: true" style="font-size:12px;">&lt;!-- Start Cetas Web Analytics Tracker --&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
    var cetas_baseUrl = &#39;https://webfeeds.cetas.net&#39;;
    var _caq = _caq || [];
    _caq.push([&#39;setAppKey&#39;,&#39;PUT_HERE_THE_APPLICATION_KEY_FROM_THE_APPLICATION_FEED_REGISTRATION_IN_CETAS_WEB_UI&#39;]);
    _caq.push([&#39;trackPageView&#39;]);
    (function() {
    var cetas = document.createElement(&#39;script&#39;); cetas.type = &#39;text/javascript&#39;; cetas.async = true;
    cetas.src = cetas_baseUrl + &#39;/js/api/cetas-tracker.js&#39;;
    var cetas_s = document.getElementsByTagName(&#39;script&#39;)[0];
    cetas_s.parentNode.insertBefore(cetas, cetas_s);
    }());
&lt;/script&gt;
&lt;!-- Finish Cetas Web Analytics Tracker --&gt;

</pre>
</div></div>    <div class="aui-message hint shadowed information-macro">
                            <span class="aui-icon icon-hint"></span>
                <div class="message-content">
                            <div class="message-content"><p>When the page is loaded on the browser, the code above loads cetas-tracker.js from the Cetas site and then invokes two APIs: the 'setAppKey' API and the 'trackPageView' API that sends the actual page view information to Cetas (check details in sections below).</p></div>
                    </div>
    </div>
<h3 id="JavaScriptDataIngestSDK-APIs">APIs</h3><ol><li><p><strong>Setting the Application key</strong></p><p>This method sets the application key so that the tracking code sends the tracking data to the correct Cetas project and application combination.</p><p>Parameters: appKey(required)</p><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'setAppKey'</code> <code class="javascript plain">,</code> <code class="javascript string">'your application key here!'</code> <code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div></div></div></li><li><strong>Page visit event tracking</strong> <br /> <br />This method tracks the page URL, title and visitor's screen, browser, and OS information.<br /><p>Parameters: url(optional)</p><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'trackPageView'</code> <code class="javascript plain">]);   </code> <code class="javascript comments">// this method gets the visited URL automatically</code></div><div class="line number2 index1 alt1"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'trackPageView'</code> <code class="javascript plain">, </code> <code class="javascript string">'/securityzone.html'</code> <code class="javascript plain">]);    </code> <code class="javascript comments">// this method overrides the URL</code></div></div></td></tr></tbody></table></div></div></div></li><li><strong>Page click event tracking</strong> <br /> <br />This method tracks the mouse click events, including the coordinates of the mouse click position.<br /><p>Parameters: N/A</p><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'trackClicks'</code> <code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div><p> </p></div></div><p> </p></li><li><strong>eCommerce event tracking</strong> <br /> <br />There are three APIs here to support eCommerce event tracking as described below. The site administrator (or the developer) needs to explicitly use these APIs and assign the corresponding values from the page variables to be able to perform eCommerce-type of analytics.<br /> <br />1. <strong>Transaction Record</strong> <br /><p>This method tracks the information of an overall transaction on an eCommerce site (e.g. a customer buying a set of items in a cart). </p><p>Parameters: </p><br /><ul><li>order_id(required)</li><li>store_name(optional)</li><li>total_amount(required)</li><li>tax(optional)</li><li>shipping(optional)</li><li>payment_gateway(optional)</li><li>city(optional)</li><li>state(optional)</li><li>country(optional)</li></ul><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'addTrans'</code> <code class="javascript plain">,</code></div><div class="line number2 index1 alt1"><code class="javascript string">'order123'</code> <code class="javascript plain">, </code> <code class="javascript comments">// the id of the order</code></div><div class="line number3 index2 alt2"><code class="javascript string">'test-app'</code> <code class="javascript plain">,  </code> <code class="javascript comments">// the source or store name that originated the transaction</code></div><div class="line number4 index3 alt1"><code class="javascript string">'100.50'</code> <code class="javascript plain">, </code> <code class="javascript comments">// the total amount of revenue - required</code></div><div class="line number5 index4 alt2"><code class="javascript string">'1.25'</code> <code class="javascript plain">, </code> <code class="javascript comments">// amount of tax</code></div><div class="line number6 index5 alt1"><code class="javascript string">'3.50'</code> <code class="javascript plain">,  </code> <code class="javascript comments">// amount of shipping</code></div><div class="line number7 index6 alt2"><code class="javascript string">'paypal'</code> <code class="javascript plain">, </code> <code class="javascript comments">// transaction gateway name</code></div><div class="line number8 index7 alt1"><code class="javascript string">'Palo Alto'</code> <code class="javascript plain">, </code> <code class="javascript comments">// city</code></div><div class="line number9 index8 alt2"><code class="javascript string">'CA'</code> <code class="javascript plain">, </code> <code class="javascript comments">//state</code></div><div class="line number10 index9 alt1"><code class="javascript string">'United States'</code> <code class="javascript comments">//country</code></div><div class="line number11 index10 alt2"><code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div><p> </p></div></div><p>2. <strong>Items Record</strong></p><p>This method tracks the individual items of a transaction.</p><p>Parameters: </p><br /><ul><li>order_id(required)</li><li>sku_NO.(required)</li><li>product_name(required)</li><li>category(optional)</li><li>unit price(optional)</li><li>quantity(optional)</li></ul><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'addItem'</code> <code class="javascript plain">, </code> <code class="javascript string">'order123'</code> <code class="javascript plain">, </code> <code class="javascript string">'SKU123'</code> <code class="javascript plain">, </code> <code class="javascript string">'iPad'</code> <code class="javascript plain">, </code> <code class="javascript string">'top100'</code> <code class="javascript plain">, 499.00, 1]);</code></div><div class="line number2 index1 alt1"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'addItem'</code> <code class="javascript plain">, </code> <code class="javascript string">'order223'</code> <code class="javascript plain">, </code> <code class="javascript string">'SKU456'</code> <code class="javascript plain">, </code> <code class="javascript string">'iPhone4s'</code> <code class="javascript plain">, </code> <code class="javascript string">'top100'</code> <code class="javascript plain">, 299.00, 2]);</code></div></div></td></tr></tbody></table></div><p> </p></div></div><p>3. <strong>Transaction Commit</strong></p><p>This method sends the transaction and all the item data to Cetas.</p><p>Parameters:  N/A</p><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'trackTrans'</code> <code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div></div></div></li><li><strong>User action event tracking</strong> <br /> <br />This method tracks user actions when visiting the corresponding Web page. It can be used for generation of funnel stages in an eCommerce site or to track any other user action that needs to be communicated to the analytics engine.                             <br /><p>Parameters:</p><br /><ul><li>action_category(required)</li><li>action_name(required)</li><li>action_label(required)</li><li>number_value(optional)</li></ul><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'trackAction'</code> <code class="javascript plain">,</code> <code class="javascript string">'comment'</code> <code class="javascript plain">,</code> <code class="javascript string">'publish'</code> <code class="javascript plain">, </code> <code class="javascript string">'number'</code> <code class="javascript plain">, 10]);</code></div></div></td></tr></tbody></table></div></div></div></li><li><strong>Custom event tracking</strong> <br /> <br />This method tracks custom events. It is the responsibility of the site owner (or the developer) to choose the appropriate event categories.                                                         <br /><p>Parameters:</p><br /><ul><li>event_category(required)</li><li>event_key(required, repeatable with 'event_value')</li><li>event_value(required, repeatable with 'event_value')</li></ul><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'trackEvent'</code> <code class="javascript plain">,</code> <code class="javascript string">'closePage'</code> <code class="javascript plain">,</code> <code class="javascript string">'key1'</code> <code class="javascript plain">,</code> <code class="javascript string">'value1'</code> <code class="javascript plain">,</code> <code class="javascript string">'key2'</code> <code class="javascript plain">,</code> <code class="javascript string">'value2'</code> <code class="javascript plain">, </code> <code class="javascript string">'key3'</code> <code class="javascript plain">, </code> <code class="javascript string">'value3'</code> <code class="javascript plain">, ......]);</code></div></div></td></tr></tbody></table></div></div></div></li><li><strong>Gaming Tracking</strong> <br /> <strong> <br /> </strong>To support the gaming industry vertical, we offer a set of gaming-specific APIs/methods as described below.<br /> <br /><ol><li>Common Event Tracking<br /> <br />This method tracks gaming events such as 'start game', 'stop game' and 'level upgrade'.<br /><p>Parameters:</p><br /><ul><li>action_name (required)</li><li>game_id (required)</li><li>game_name (required)</li><li>game_version (optional)</li><li>game_level(optional)</li></ul><p>Sample (sends a start game event for a game called &quot;My Game Title&quot; with version 1.1 for level 2):</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'trackGame'</code> <code class="javascript plain">,</code> <code class="javascript string">'START'</code> <code class="javascript plain">,</code> <code class="javascript string">'001_002'</code> <code class="javascript plain">,</code> <code class="javascript string">'My Game Title'</code> <code class="javascript plain">,</code> <code class="javascript string">'1.1'</code> <code class="javascript plain">,</code> <code class="javascript string">'2'</code> <code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div><p> </p></div></div><p> </p></li><li>Purchase Event Tracking<br /> <br />This method facilitates tracking of virtual good purchases. It tracks the player's purchase event when they are playing the game and it follows a similar structure with the corresponding eCommerce API consisting of three sections described below.<br /><p>a) Add Transaction</p><p>Parameters:</p><br /><ul><li>game_id (required)</li><li>transaction_id (required)</li><li>total_amount (required)</li><li>game_version (optional)</li><li>game_level(optional)</li></ul><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'addGameTrans'</code> <code class="javascript plain">,</code> <code class="javascript string">'001_002'</code> <code class="javascript plain">,</code> <code class="javascript string">'order_001'</code> <code class="javascript plain">,</code> <code class="javascript string">'29.99'</code> <code class="javascript plain">,</code> <code class="javascript string">'1.1'</code> <code class="javascript plain">, </code> <code class="javascript string">'2'</code> <code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div><p> </p></div></div><p>b) Add Transaction Item</p><p>Parameters:</p><br /><ul><li>game_id (required)</li><li>transaction_id (required)</li><li>item_name (required)</li><li>item_price (optional)</li><li>item_quantity(optional)</li></ul><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'addGameItem'</code> <code class="javascript plain">,</code> <code class="javascript string">'001_002'</code> <code class="javascript plain">,</code> <code class="javascript string">'order_001'</code> <code class="javascript plain">,</code> <code class="javascript string">'magic ball'</code> <code class="javascript plain">,</code> <code class="javascript string">'9.99'</code> <code class="javascript plain">, </code> <code class="javascript string">'2'</code> <code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div><p> </p></div></div><p> </p><p>c) Commit the Transaction</p><p>Parameters: N/A</p><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'trackGameTrans'</code> <code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div><p> </p></div></div><p> </p></li><li>Invitation Event Tracking<br /> <br />This method track player's invitations to friends from inside the game. It is used to perform engagement analysis.<br /><p>Parameters:</p><br /><ul><li>game_id (required)</li><li>send_to (required, friends list which separated by comma)</li><li>channel (optional)</li><li>game_version(optional)</li><li>game_level(optional)</li></ul><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'trackGameInvitation'</code> <code class="javascript plain">,</code> <code class="javascript string">'001_002'</code> <code class="javascript plain">,</code> <code class="javascript string"> <a href="https://confluence.greenplum.com/mailto:" rel="nofollow">'Bob@game.net</a>, <a href="mailto:Alice@abc.com" class="external-link" rel="nofollow">Alice@abc.com</a>'</code> <code class="javascript plain">,</code> <code class="javascript string">'Facebook'</code> <code class="javascript plain">,</code> <code class="javascript string">'1.2'</code> <code class="javascript plain">, </code> <code class="javascript string">'3'</code> <code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div></div></div></li></ol></li><li><strong>Set Visitor Type (Paid User or Not)</strong> <br /> <br />This method allows setting the current visitor's type, to a paid user or just a guest. When this API method is not invoked, the paid flag will be set to &quot;unknown&quot;.<br />The visitor type is stored on the browser, and once this API is invoked, each subsequent request will contain the new value unless the site owner (or the developer) invokes it again. You can find more information on this <a href="https://cetasbigdata.atlassian.net/wiki/pages/viewpage.action?pageId=4063257" class="external-link" rel="nofollow">here</a>.<br /><p>Parameters:</p><br /><ul><li>is_paid_user (required, boolean only)</li></ul><p>Sample:</p><div><div class="syntaxhighlighter nogutter  javascript"><p> </p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><div class="container" title="Hint: double-click to select code"><div class="line number1 index0 alt2"><code class="javascript plain">_caq.push([</code> <code class="javascript string">'setVisitorIsPaid'</code> <code class="javascript plain">,</code> <code class="javascript keyword">true</code> <code class="javascript plain">]);</code></div></div></td></tr></tbody></table></div><p> </p></div></div><p> </p></li></ol><h2 id="JavaScriptDataIngestSDK-VerticalIndustryAPIs">Vertical Industry APIs</h2><p>For more specific information of Gaming vertical and eCommerce tracking visit the following links:</p><ul><li><a href="https://cetasbigdata.atlassian.net/wiki/pages/viewpage.action?pageId=4063238" class="external-link" rel="nofollow">Gaming APIs</a></li><li><a href="https://cetasbigdata.atlassian.net/wiki/pages/viewpage.action?pageId=4063236" class="external-link" rel="nofollow">eCommerce APIs</a> </li></ul><p>       </p><p> </p></div><pre class="message-content"> </pre><div><div class="syntaxhighlighter nogutter  javascript"><p> </p></div></div>
                    </div>

                    
                 
                </div>             </div> 
            <div id="footer" style="background: url(https://confluence.greenplum.com/images/border/border_bottom.gif) repeat-x;">
                <p><small>Document generated by Confluence on Nov 12, 2013 14:19</small></p>
            </div>
        </div>     </body>
</html>
